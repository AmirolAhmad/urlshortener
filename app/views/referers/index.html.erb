<div class="ui inverted masthead segment">
  <div class="ui page grid">
    <div class="column">
      <div class="ui inverted red menu">
        <%= link_to "URL Shortner", root_url, class: 'header item' %>
      </div>
      <%= image_tag('cat.png', class: 'ui medium image') %>
      <div class="ui hidden transition information">
        <h1 class="ui inverted header">
          MindValley URL Shortener
        </h1>
        <p>Paste your long URL here:</p>

       <%= render partial: "form" %>

				<% if flash[:notice] %>
					<p style="color:#00b5ad;"><%= flash[:notice] %></p>
				<% end %>

				<% if flash[:alert] %>
					<p style="color:#d95c5c;"><%= flash[:alert] %></p>
				<% end %>

      </div>
    </div>
  </div>
</div>

<% cache "referer-index", skip_digest: true do %>

<div class="ui centered page grid">
	<h3 class="ui horizontal header divider">
    <i class="list layout icon"></i>
    List of Shorten URL
  </h3>
	<div class="sixteen wide column">

		<table class="ui celled table striped">
			<thead>
				<tr>
					<th>Source URL</th>
					<th>Created On</th>
					<th>Shorten URL</th>
					<th class="collapsing">Clicks</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>
				<% @referers.each do |r| %>
				<tr>
					<td><%= r.url %></td>
					<td><%= r.created_at.strftime("%d %B %Y") %><p style="font-size:11px;color:grey;"><%= time_ago_in_words(r.created_at) + " ago" %></p></td>
					<td><%= r.shorten_url %></td>
					<td><%= r.click %></td>
					<td>
						<div class="ui mini buttons">
							<%= link_to "Visit", r.slug, target: '_blank', class: "ui blue button show-popup",  "data-content" => "#{r.shorten_url}" %>
							<button id="<%= r.slug %>" data-clipboard-text="<%= r.shorten_url %>" type="button" class="ui green button show-popup" data-content="Copy to clipboard"><i class="copy icon"></i></button>
						</div>
					</td>
				</tr>

				<!-- Script for Copy to Clipboard start -->
				<script type="text/javascript">
				  var clientText = new ZeroClipboard( $("#<%= r.slug %>"), {
				    moviePath: "/assets/ZeroClipboard.swf",
				    debug: false
					});

					$("#<%= r.slug %>").on("click", function(){
				    alert("Short URL copied to clipboard");
				  });
				</script>
				<!-- Script for Copy to Clipboard end -->

				<% end %>
			</tbody>
		</table>

	</div>
</div>

<% end %>